version: 0.0.2.{build}

shallow_clone: true

image: Visual Studio 2017

cache:
  - "%APPDATA%\\stack"
  - .stack-work

build_script:
  - choco install haskell-stack
  - stack --no-terminal setup > NUL
  - rmdir /s /q %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\msys2-20150512
  - mklink /D %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\msys2-20150512 C:\\msys64
  - rmdir /S /Q %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\ghc-8.2.1\\mingw
  - mklink /D %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\ghc-8.2.1\\mingw C:\\msys64\\mingw64
  - rmdir /S /Q %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\ghc-8.2.1\\perl
  - mklink /D %LOCALAPPDATA%\\Programs\\stack\\x86_64-windows\\ghc-8.2.1\\perl C:\\msys64\\usr\\bin
  - stack --no-terminal exec pacman -- -Syu --force --noconfirm --noprogressbar
  - stack --no-terminal exec pacman -- -Syu --force --noconfirm --noprogressbar
  - stack --no-terminal exec pacman -- -Syu --force --noconfirm --noprogressbar
  - stack --no-terminal build --haddock

test: off
